
Bite-sized Quiver test using the HCV dataset

  $ export DATA=$TESTDIR/../data
  $ export INPUT=$DATA/hcv/aligned_reads.cmp.h5
  $ export REFERENCE=$DATA/hcv/HCV_Ref_For_187140.fasta

Quiver actually makes one error here, which is kind of disappointing,
but this data is from a really ancient instrument-software version, so
I'm not all that surprised.

  $ quiver -x0 -q0 $INPUT -r $REFERENCE -o v.gff -o css.fa -o css.fq
  2013-02-01 19:31:24,442 [WARNING] This .cmp.h5 file lacks some of the QV data tracks that are required for optimal performance of the Quiver algorithm.  For optimal results use the ResequencingQVs workflow in SMRTPortal with bas.h5 files from an instrument using software version 1.3.1 or later.

  $ cat v.gff
  ##gff-version 3
  ##pacbio-variant-version 1.4
  ##date Fri Feb  1 19:31:28 2013
  ##feature-ontology http://song.cvs.sourceforge.net/*checkout*/song/ontology/sofa.obo?revision=1.12
  ##source GenomicConsensus 0.5.0
  ##source-commandline /Users/dalexander/Dropbox/Sources/git/GenomicConsensus/variantCaller.py --algorithm=quiver -x0 -q0 /Users/dalexander/Dropbox/Sources/git/GenomicConsensus/tests/integration/../data/hcv/aligned_reads.cmp.h5 -r /Users/dalexander/Dropbox/Sources/git/GenomicConsensus/tests/integration/../data/hcv/HCV_Ref_For_187140.fasta -o v.gff -o css.fa -o css.fq
  ##sequence-region 5primeEnd 1 156
  ##sequence-region 3primeEnd 1 386
  3primeEnd\t.\tdeletion\t296\t296\t.\t.\t.\treference=G;coverage=76;confidence=5;length=1 (esc)


  $ cat css.fa
  >5primeEnd|quiver
  GGAACCGGTGAGTACACCGGAATTGCCAGGACGACCGGGTCCTTTCGTGGATAAACCCGC
  TCAATGCCTGGAGATTTGGGCGTGCCCCCGCAAGACTGCTAGCCGAGTAGTGTTGGGTCG
  CGAAAGGCCTTGTGGTACTGCCTGATAGGGTGCTTG
  >3primeEnd|quiver
  TACCTGGTCATAGCCTCCGTGAAGGCTCTCAGGCTCGCTGCATCCTCCGGGACTCCCTGA
  CTTTCACAGATAACGACTAAGTCGTCGCCACACACGAGCATGGTGCAGTCCTGGAGCCCA
  GCGGCTCGACAGGCTGCTTTGGCCTTGATGTAGCAGGTGAGGGTGTTACCACAGCTGGTC
  GTCAGTACGCCGCTCGCGCGGCACCTGCGATAGCCGCAGTTTTCCCCCCTTGAATTAGTA
  AGAGGGCCCCCGACATAGAGCCTCTCGGTGAGGGACTTGATGGCCACGCGGGCTTGGGGT
  CCAGGTCACAACATTGGTAAATTGCCTCCTCTGTACGGATATCGCTCTCAGTGACTGTGG
  AGTCAAAGCAGCGGGTATCATACGA

  $ cat css.fq
  @5primeEnd|quiver
  GGAACCGGTGAGTACACCGGAATTGCCAGGACGACCGGGTCCTTTCGTGGATAAACCCGCTCAATGCCTGGAGATTTGGGCGTGCCCCCGCAAGACTGCTAGCCGAGTAGTGTTGGGTCGCGAAAGGCCTTGTGGTACTGCCTGATAGGGTGCTTG
  +
  """SRQPQQQPPPPPQPQPQPQPQQPRQPQQQPQPQQQQPPQQQRPPPPQQPPRQQQPQQQQQQQPQQQQQPPPQQRQQQQQPQPQQRQQRQQQOPPRPQQQQQPQPQQPQPPRPRQPPQPQPQQQQQRQQPRPQPPQPPPQQPPQPQQQQQR"""
  @3primeEnd|quiver
  TACCTGGTCATAGCCTCCGTGAAGGCTCTCAGGCTCGCTGCATCCTCCGGGACTCCCTGACTTTCACAGATAACGACTAAGTCGTCGCCACACACGAGCATGGTGCAGTCCTGGAGCCCAGCGGCTCGACAGGCTGCTTTGGCCTTGATGTAGCAGGTGAGGGTGTTACCACAGCTGGTCGTCAGTACGCCGCTCGCGCGGCACCTGCGATAGCCGCAGTTTTCCCCCCTTGAATTAGTAAGAGGGCCCCCGACATAGAGCCTCTCGGTGAGGGACTTGATGGCCACGCGGGCTTGGGGTCCAGGTCACAACATTGGTAAATTGCCTCCTCTGTACGGATATCGCTCTCAGTGACTGTGGAGTCAAAGCAGCGGGTATCATACGA
  +
  """SQPRPQPQPQQQQPQPQQQQPQQQPPQPPPQPPPPQQPQPPQQQQPRQQQQHQQQPQQQQRQQRQQQPQQPPQPPPRQPQQQQPQQQQQPPPPPPPPPQSPQPQQPQRRQRPPOQQQPRQQQQPQQPQPQQPRPQQQPQPQQRQQQPPPQPQQRQRQQQRQPPQPPRQQPPRPPRQPPPPPPPQPQQPPQPPPPQPPQPQQQPQQQQQQQPQPPPQQQQQ=QRQQQQQQQRQQPQPQQPPQQQAQQQQQQPQQQQQPQRPQPPQQPQPQRQQPQQQQPQQQRPQQPPQRPPQ&QQQPQQQPRQQQQRRPPPRPQQPQRPRPPQPPQPQPQQPQQRPRQPQPQQPPRPQQQQQPPPPQQQQPQQQ1QQPQQRQPQQPQQQ"""
